<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Intermediate JavaScript - The Effective Developer Series</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">
		<link rel="stylesheet" href="css/theme/custom.css">
		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
                
                <!-- Title of presentation -->
				<section>
					<h1>Intermediate JavaScript</h1>
					<h3>Effective Developer Series</h3>
					<p>
						<small>Created by <a href="https://github.com/atomicframeworks" target="_blank">Kevin McGinty</a><br> <br>
                          <small><a href="https://github.com/atomicframeworks/Effective-Developer-Series-Intermediate-JavaScript" target="_blank">Get the slides</a></small>
                        </small>
					</p>
				</section>
                
                <!-- Executable Code -->
                <section>
                    <section>
                        <h4>Executable Code</h4>
                        <p>
                          <img src="/img/boxcat.jpg"/> <br>
                        </p>
                    </section>
                    <section>
                        <h4>Types of executable code</h4>
                        <div>
                            <ul>
                                <li>Global code</li>
                                <li>Eval code</li>
                                <li>Function code</li>
                                <li>Module code</li>
                            </ul>
                            <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-types-of-source-code" target="_blank">ECMAScript Language Specification 6.0 - Types of Executable Code</a>
                            </small></small>
                        </div>
                    </section>
                    <section>
                        <h4>Global Code</h4>
                        <p>
                            "Source text that is treated as an ECMAScript <i>Script</i>. The global code of a particular Script does not include any source text that is parsed as part of a <i>FunctionDeclaration, FunctionExpression, GeneratorDeclaration, GeneratorExpression, MethodDefinition, ArrowFunction, ClassDeclaration,</i> or <i>ClassExpression</i>."
                            <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-types-of-source-code" target="_blank">ECMAScript Language Specification 6.0 - Types of Executable Code</a>
                            </small></small>
                        </p>
                    </section>
                    <section>
                        <h4>Global Code Example</h4>
                        <div>
                            <pre class="hljs javascript" data-trim contenteditable>
var a = 'global';
</pre>
                        </div>
                    </section>
                    <section>
                        <h4>Eval Code</h4>
                        <p>
                            "Source text that is treated as an ECMAScript <i>Script</i>. The global code of a particular Script does not include any source text that is parsed as part of a <i>FunctionDeclaration, FunctionExpression, GeneratorDeclaration, GeneratorExpression, MethodDefinition, ArrowFunction, ClassDeclaration,</i> or <i>ClassExpression</i>."
                            <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-types-of-source-code" target="_blank">ECMAScript Language Specification 6.0 - Types of Executable Code</a>
                            </small></small>
                        </p>
                    </section>
                    <section>
                        <h4>Eval Code Example</h4>
                        <div>
                            <pre class="hljs javascript" data-trim contenteditable>
eval(
    'var a = "global";'
);
</pre>
                        </div>
                    </section>
                    <section>
                        <h4>Function Code</h4>
                        <div>
                            "Function code is source text that is parsed to supply the value of the [[ECMAScriptCode]] and [[FormalParameters]] internal slots of an ECMAScript function object. The function code of a particular ECMAScript function does not include any source text that is parsed as the function code of a nested <i>FunctionDeclaration, FunctionExpression, GeneratorDeclaration, GeneratorExpression, MethodDefinition, ArrowFunction, ClassDeclaration,</i> or <i>ClassExpression</i>."
                            <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-types-of-source-code" target="_blank">ECMAScript Language Specification 6.0 - Types of Executable Code</a>
                            </small></small>
                        </div>
                    </section>
                    <section>
                        <h4>Function Code Example</h4>
                        <div>
                            <pre class="hljs javascript" data-trim contenteditable>
var add = new Function('a', 'b', 'return a + b');
</pre>
                            
                            Note: Various ECMAScript language elements cause the creation of ECMAScript function objects. <br><br>
                        </div>
                        <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-ecmascript-language-functions-and-classes" target="_blank">ECMAScript Language Specification 6.0 - Functions and Classes</a>
                            </small></small>
                    </section>
                    <section>
                        <h4>Module Code</h4>
                        <div>
                            "Module code is source text that is code that is provided as a ModuleBody. It is the code that is directly evaluated when a module is initialized. The module code of a particular module does not include any source text that is parsed as part of a nested <i>FunctionDeclaration, FunctionExpression, GeneratorDeclaration, GeneratorExpression, MethodDefinition, ArrowFunction, ClassDeclaration,</i> or <i>ClassExpression</i>."
                            <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-types-of-source-code" target="_blank">ECMAScript Language Specification 6.0 - Types of Executable Code</a>
                            </small></small>
                        </div>
                    </section>   
                    <section>
                        <h4>Module Code Example</h4>
                        <div>
                            <pre class="hljs javascript" data-trim contenteditable>
var EXPORTED_SYMBOLS = ["foo"];

function foo() {
  return "foo";
}
</pre>

                            <pre class="hljs javascript" data-trim contenteditable>
Components.utils.import("resource://app/my_module.jsm");

alert(foo());
</pre>                            
                        </div>
                    </section>
                </section>
                
                
                <!-- Execution Context -->
                <section>
                    <section>
                        <h4>Execution Context</h4>
                        <div>
                            <img src="/img/context.png" width="300px"/> <br>
                            <small>Not scope chain</small>
                        </div>
                    </section>
                    <section>
                        <h4>So what is it? - Spec says...</h4>
                        <div>
                            <blockquote class="monospaced">
                                &ldquo;An execution context is a specification device that is used to <span class="highlight">track the runtime evaluation of code</span> by an ECMAScript implementation. <span class="fragment">At any point in time, there is at most <span class="highlight">one execution context that is actually executing code</span>.</span> <span class="fragment">This is known as the <span class="highlight">running execution context</span>.</span>&rdquo;
                            </blockquote>
                            
                            <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-execution-contexts" target="_blank">ECMAScript Language Specification - Execution Contexts</a>
                            </small></small>
                        </div>
                    </section>
                    <section>
                        <h4>Okay...</h4>
                        <div>
                        It's an abstract concept used by the specification to help define and differentiate executable code. <br> <br>
                        Every time control is transferred to ECMAScript executable code, control is entering an execution context.
                            
                        <aside class="notes">So the key to keep in mind is that every time we transfer executable code context we are entering a new execution context -- take a second to flip back to point out the executable code defintions </aside>

                            
                        </div>
                    </section>
                    <section>
                        <h4>So what is it? - Spec says...</h4>
                        <div>
                            <blockquote class="monospaced">
                                &ldquo;A <span class="highlight">stack</span> is used to track execution contexts. <span class="fragment">The <span class="highlight">running execution context is always the top</span> element of this stack.</span> <span class="fragment">A <span class="highlight">new execution context is created whenever control is transferred</span> from the executable code associated with the currently running execution context to executable code that is not associated with that execution context.</span> <span class="fragment">The newly created execution context is <span class="highlight">pushed onto the stack and becomes the running execution context.</span></span>&rdquo;
                            </blockquote>
                            
                            <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-execution-contexts" target="_blank">ECMAScript Language Specification - Execution Contexts</a>
                            </small></small>
                        </div>
                    </section>
                    
                    <section>
                        <h4>Execution Context - Example</h4>
                        <img src="/img/execution-context/1-1.png"/>
                        <img src="/img/execution-context/1.png"/> <br>
                          <aside class="notes">Simple example - Explain the global and foo contexts. </aside>
                    </section>
                    
                    <section>
                        <h4>Execution Context - Example</h4>
                        <img src="/img/execution-context/2-1.png" width="400px"/>
                        <img src="/img/execution-context/2.png"/>
                        <img src="/img/execution-context/2-2.png"/> <br>
                        
                         
                          <aside class="notes">Every time a function returns, the current execution context is exited and popped off the stack accordingly. Once the code is completed and globalContext exeuctes until program end.
                        </aside>
                    </section>
                    
                    <section>
                        <h4>Eval - Calling Context</h4>
                        <img style="width:50%;" src="/img/execution-context/3-1.png"/>
                        <img style="width:80%;" src="/img/execution-context/3.png"/> <br>
                        
                         
                          <aside class="notes">With eval things get weird -- There is a concept of a calling context.  This is the context from which eval is called. Actions made by eval influence the calling context.
                        </aside>
                    </section>
                    
                    <section>
                        <h4>Execution context contains 3 things</h4>
                        <div>
                            <ol>
                                <li>
                                    VariableEnvironment
                                </li>
                                <li>
                                    LexicalEnvironment
                                </li>
                                <li>
                                    ThisBinding
                                </li>
                            </ol>
                        </div>
                    </section>   
                </section>
              
                 <!-- VariableEnvironment & LexicalEnvironment -->
                <section>
                    <section>
                        <h4>LexicalEnvironments, VariableEnvironments, and EnvironmentRecords</h4>
                        <div>
                            <img src="/img/lionstigersbears.png"/>
                        </div>
                    </section>
                    
                    <section>
                        <h4>Lexical Environment</h4>
                        <div>
                            
                            <blockquote class="monospaced">
                                &ldquo;A Lexical Environment is a specification type used to define the association of Identifiers to specific variables and functions based upon the <span class="highlight">lexical nesting structure</span> of ECMAScript code.&rdquo;
                            </blockquote>
                            <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-lexical-environments" target="_blank">ECMAScript Language Specification 6.0 - Lexical Environments</a>
                            </small></small>
                        </div>
                    </section>
                    
                    <section>
                        <h4>Okay...</h4>
                        Lexical
                        <aside class="notes">Lexical analysis refers to the process of converting a sequence of characters to tokens. So in this sense lexical refers to where "lexically" in the source text the environment appears.  This is important because lexical scope means compile time scope. In other words the scoping decisions have already been made. So we should be able to look at our code and see lexically the scope of our variables. </aside>

                        
                    </section>
                    
                    <section>
                         <blockquote class="monospaced">
                             &ldquo;A Lexical Environment consists of an <span class="highlight">Environment Record</span> and a possibly null <span class="highlight">reference to an outer Lexical Environment.</span> <span class="fragment">Usually a Lexical Environment is associated with some specific syntactic structure of ECMAScript code such as a <span class="highlight"><i>FunctionDeclaration, a BlockStatement,</i> or a <i>Catch</i> clause</span> of a <i>TryStatement</i> and a new Lexical Environment is created each time such code is evaluated.</span>&rdquo;
                            </blockquote>
                        <aside class="notes">If the code is running in the global context the reference to the outer environment will be null. A new lexical environment is created for of the structures</aside>
                    </section>
                    
                    <section>
                        <h4>Contains 2 things</h4>
                        <ol>
                            <li>EnvironmentRecord</li>
                            <li>Reference to the outer environment</li>
                        </ol>
                        <aside class="notes">The reference to the outer environment will be null if it is the global context</aside>
                    </section>
                    
                    <section>
                        <h4>EnvironmentRecord</h4>
                        <div>
                           "An Environment Record records the identifier bindings that are created within the scope of its associated Lexical Environment. It is referred to as the Lexical Environment’s EnvironmentRecord"
                        </div>
                        <aside class="notes">What this means really is that an environment record is the storage for variables for the it's context.</aside>
                    </section>
                    
                    <section>
                        <div>
                            <div>"The Lexical Environment and Environment Record types are used to explain the behaviour of name resolution in nested functions and blocks."</div>
                            <aside class="notes">So basically these things help us figure our the scope for nested functions and blocks.</aside>
                            <br>
                            <small class="caption"><small>
                                Ref: <a href="http://www.ecma-international.org/ecma-262/6.0/#sec-lexical-environment-and-environment-record-specification-types" target="_blank">ECMAScript Language Specification 6.0 - Lexical Environment and Environment Record Specification Types</a>
                            </small></small>
                        </div>
                    </section>
                   
                    <section>
                         <pre class="hljs javascript" data-trim contenteditable>
var thing = true;

function double(aNum) {
    var aNumberDoubled = aNum * 2;
}

double(4501);
</pre>
                        <div>Global Context - Environment Record Representation</div>

<pre class="hljs javascript" data-trim contenteditable>
globalEnvironment = {
    environmentRecord: {
 
        // Built-ins, etc.
        Array: function,

        // Our bindings
        thing: true,
        double: (pointer to double function)
    },
    outer: null
};
</pre>
                        <aside class="notes">Note there is no reference to an outer environment. We can see the environment record holds bindings of ours and built ins</aside>
                    </section>
                    <section>
                         <pre class="hljs javascript" data-trim contenteditable>
var thing = true;

function double(aNum) {
    var aNumberDoubled = aNum * 2;
}

double(4501);
</pre>
                        <div>Double Context - Environment Record Representation</div>
<pre class="hljs javascript" data-trim contenteditable>
doubleEnvironment = {
    environmentRecord: {
        arguments: {
            0: 4501,
            length : 1,
            callee: (pointer to double function)
        },
        aNum: 4501,
        aNumberDoubled: 9002
    },
    outer: globalEnvironment
};
</pre>
                        <aside class="notes">Note reference to outer environment, arguments object</aside>
                    </section>
                    
                    <section>
                        <h4>Execution Context Components</h4>
                        <ul>
                            <li>VariableEnvironment</li>
                            <li>LexicalEnvironment</li>
                        </ul>
                        <aside class="notes">Two components of an execution context are variable and lexical environments. Both VariableEnvironment and LexicalEnvironment by their nature are lexical environments -- with a space meaning they both statically (lexically) captures the outer bindings for inner functions created in the context. </aside>

                    </section>
                    
                    <section>
                        <h4>VariableEnvironment</h4>
                        <div>
                            "Identifies the Lexical Environment whose EnvironmentRecord holds bindings created by VariableStatements within this execution context."
                            <aside class="notes">The Variable environment component is exactly the initial storage of variables and functions of the context. Exactly its environment record is used as the data storage and is filled on entering the context stage. </aside>
                        </div>
                    </section>
                    
                    <section>
                        <pre class="hljs javascript" data-trim contenteditable>
function foo(a) {
  var b = 20;
}
 
foo(10);
</pre>
                        <div>Foo Context - VariableEnvironment Representation</div>
<pre class="hljs javascript" data-trim contenteditable>
fooContext.VariableEnvironment = {
  environmentRecord: {
    arguments: {0: 10, length: 1, callee: foo},
    a: 10,
    b: 20
  },
  outer: globalEnvironment
};
</pre>
                    </section>
                    
                    <section>
                        <h4>LexicalEnvironment</h4>
                        <div>
                           "Identifies the Lexical Environment used to resolve identifier references made by code within this execution context."
                        </div>
                        <aside class="notes">The funny thing is -- Initially the lexicalEnvironment is just a copy of the VariableEnvironment.</aside>
                    </section>
                        

                    <section>
                        <h4>So What's the Diff?</h4>
                        <div>
                            The <i>with</i> statement and <i>catch</i> clause replace the context's environment for the time of their execution. This is also the case with <i>function expressions</i>.
                            
                            <aside class="notes">For example the catch clause causes a new lexical environment that is a copy of the current and modifies it with the exception argument. This is also true for <i>function expressions</i></aside>
                            
                        </div>
                    </section>
                    
                    <section>
                        <h4>What happens?</h4>
                        <aside class="notes">New function Declaration means new variableEnvironment becomes scope</aside>
                        <img src="/img/execution-context/4.png"/>
                    </section>
                    
                    <section>
                        <h4>What happens?</h4>
                        <img src="/img/execution-context/5.png"/>
                        <aside class="notes">Function expression keeps same variableEnvironment and has new lexicalEnvironment</aside>
                    </section>
                    
                     <section>
                        <h4>What happens?</h4>
                        <img src="/img/execution-context/6.png"/>
                        <aside class="notes">Function expression new lexicalEnvironment</aside>
                    </section>
                    
                    <section>
                        <h4>What happens?</h4>
                        <img src="/img/execution-context/7.png"/>
                        <aside class="notes">Function expression new lexicalEnvironment</aside>
                    </section>
                </section>
                
                
                <section>
                    <section>
                        <h4>Hoisting</h4>
                        <div>
                            <img src="/img/hoist.jpg"/> <br>
                            <small>More on execution contexts!</small>
                        </div>
                    </section>
                    <section>
                        <h4>Life cycle of Execution Context</h4>
                        <div>
                            <ol>
                                <li>Creation phase</li>
                                <li>Execution phase</li>
                            </ol>
                        </div>
                    </section>
                    
                    <section>
                        <h4>Creation Phase</h4>
                        <div>
                            <ol>
                                <li>Variable Object (VO) is created</li>
                                <li class="fragment">Arguments object is created</li>
                                <li class="fragment">
                                    Interpreter creates properties on VO for function declarations
                                    <ul class="fragment">
                                        <li>If there are multiple definitions for the same function the interpreter will <i>override</i> it</li>
                                    </ul>
                                </li>
                                <li class="fragment">
                                    Interpreter creates properties on VO for variable declarations
                                    <ul class="fragment">
                                        <li>If the property already exists on the VO the interpreter will <i>skip</i> it</li>
                                        <li>Even though the property is <i>defined</i> on the VO it is unassgined until execution</li>
                                    </ul>
                                </li>
                                <li class="fragment">Scope chain is created</li>
                            </ol>
                            <aside class="notes">
                            Variable object is abstract concept and therefore, depending on its execution context, is any link in scope-chain including activation/global object. It's kind of like environment record</aside>
                        </div>
                    </section>
                    
                    <section>
                        <h4>Creation Phase</h4>
                        <pre class="hljs javascript" data-trim contenteditable>
var a = 1;
function foo() {
    var b = 2;
}
foo();
</pre>
                        <ol>
                            <li>Function declarations on VO</li>
                            <li>Properties for variables created on VO as <i>undefined</i></li>
                        </ol>
                    </section>
                    
                    
                    <section>
                        <h4>What happens?</h4>
                        <pre class="hljs javascript" data-trim contenteditable>
alert(foo());
function foo() {
    return 1;
}
var foo = 2;
</pre>
                        <aside class="notes">Foo is a function declaration and is assigned at creation phase.  That's why it is available before it looks like it</aside>
                        
                    </section>
                    
                    <section>
                        <h4>What happens?</h4>
                        <pre class="hljs javascript" data-trim contenteditable>
function foo(){
    return bar();
    var bar = function() {
        return 3;
    };
    function bar() {
        return 8;
    };
}
alert(foo());
</pre>
                        <aside class="notes">Foo is a function declaration and is assigned at creation phase.  That's why it is available before it looks like it</aside>
                        
                    </section>
                    
                    
                    
                
                </section>
                
                <!-- Identifier Resolution & Scope Chain -->
                <section>
                    <section>
                        <h4>Identifier Resolution</h4>
                                                  <small>Yes, this is where scope chain comes in!</small> <br>
                        <div>
                          <img src="/img/functions.jpg"/>
                        </div>
                    </section>
                    <section>
                        <h4>Identifier Resolution</h4>
                        <div>
                            The process of determining the binding of an identifier appearing in the current context by using the LexicalEnvironment component of the running execution context.
                                                    <aside class="notes">This is basically the process of determining the value of a variable when you try to reference it</aside>

                        </div>
                    </section>
                    <section>
                        <h4>Scope Chain - Look through the environments at the records</h4>
                        <img src="/img/execution-context/8.png"/>

                        <aside class="notes">The basic algorithm is look at the current lexical environment's environment record -- if not found then look at outer environment environment record repeat until the item is found or the other reference is null which means there is a reference error because the identifier doesn't exist</aside>
                    </section>
                    
                    <section>
                        <img src="/img/scope/1.png"/>
                        <aside class="notes">Here we have global context. You can see we have our 'some' variable defined and no outer environment</aside>
                    </section>
                    
                    <section>
                        <img src="/img/scope/2.png"/>
                        <aside class="notes">Here we enter the a function which is a new environment where it defines 'example'</aside>
                    </section>
                    
                    <section>
                        <img src="/img/scope/3.png"/>
                        <aside class="notes">Final context here.  Notice how they are nested? 'code' is defined.  We then see a reference to 'some example code'.  Follow the example for them</aside>
                    </section>
                    
                </section>
			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
